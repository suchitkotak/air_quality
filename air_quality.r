#SO2  Prediction

> bandrapro<-read.csv('bandrapro.csv')

> attach(bandrapro)

> qplot(Date,so2,data=bandrapro)

 

> summary(so2)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  12.00   16.00   18.00   19.91   23.00   33.00 
> dsso2<-bandrapro$Date
> y<-log(bandrapro$so2)
> dfso2<-data.frame(dsso2,y)

> qplot(dsso2,y,data=dfso2)

 
> mso2<-prophet(dfso2)
Initial log joint probability = -2.21451
Optimization terminated normally: 
  Convergence detected: absolute parameter change was below tolerance

> future<-make_future_dataframe(mso2,periods = 5)
> futureso2<-make_future_dataframe(mso2,periods = 5)
> head(futureso2)
          ds
1 2018-01-01
2 2018-01-02
3 2018-01-03
4 2018-01-04
5 2018-01-05
6 2018-01-06



> forecastso2<-predict(mso2,futureso2)
> head(forecastso2)
          ds    trend    seasonal seasonal_lower seasonal_upper seasonalities seasonalities_lower
1 2018-01-01 2.568375  0.04085310     0.04085310     0.04085310    0.04085310          0.04085310
2 2018-01-02 2.587132  0.02636674     0.02636674     0.02636674    0.02636674          0.02636674
3 2018-01-03 2.605889 -0.01449138    -0.01449138    -0.01449138   -0.01449138         -0.01449138
4 2018-01-04 2.624646 -0.04541206    -0.04541206    -0.04541206   -0.04541206         -0.04541206
5 2018-01-05 2.643403 -0.01616556    -0.01616556    -0.01616556   -0.01616556         -0.01616556
6 2018-01-06 2.662159 -0.01080191    -0.01080191    -0.01080191   -0.01080191         -0.01080191
  seasonalities_upper      weekly weekly_lower weekly_upper yhat_lower yhat_upper trend_lower trend_upper
1          0.04085310  0.04085310   0.04085310   0.04085310   2.405339   2.810306    2.568375    2.568375
2          0.02636674  0.02636674   0.02636674   0.02636674   2.423126   2.801784    2.587132    2.587132
3         -0.01449138 -0.01449138  -0.01449138  -0.01449138   2.393028   2.784143    2.605889    2.605889
4         -0.04541206 -0.04541206  -0.04541206  -0.04541206   2.384037   2.773260    2.624646    2.624646
5         -0.01616556 -0.01616556  -0.01616556  -0.01616556   2.440043   2.829372    2.643403    2.643403
6         -0.01080191 -0.01080191  -0.01080191  -0.01080191   2.456346   2.849431    2.662159    2.662159
      yhat
1 2.609228
2 2.613499
3 2.591397
4 2.579234
5 2.627237
6 2.651357
> tail(forecastso2[c('ds','yhat','yhat_lower','yhat_upper')])
           ds     yhat yhat_lower yhat_upper
69 2018-03-10 2.839263   2.633786   3.022336
70 2018-03-11 2.858357   2.664285   3.043745
71 2018-03-12 2.868201   2.665404   3.081123
72 2018-03-13 2.842356   2.656841   3.045444
73 2018-03-14 2.790139   2.606681   2.985963
74 2018-03-15 2.747860   2.559921   2.940311

> exp(2.83)
[1] 16.94546
> exp(2.85)
[1] 17.28778





>plot(mso2,forecastso2)

 
>prophet_plot_components(mso2,forecastso2)


 



#No2  Prediction

>qplot(Date,no2,data=bandrapro)

 


> summary(no2)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  21.00   70.00   87.00   91.51  109.00  214.00 
> dsno2<-bandrapro$Date
> y<-log(bandrapro$no2)
> dfno2<-data.frame(dsno2,y)
> qplot(dsno2,y,data=dfno2)
 
> mno2<-prophet(dfno2)
Initial log joint probability = -2.77209
Optimization terminated normally: 
  Convergence detected: absolute parameter change was below tolerance

> futureno2<-make_future_dataframe(mno2,periods = 5)
> head(futureno2)
          ds
1 2018-01-01
2 2018-01-02
3 2018-01-03
4 2018-01-04
5 2018-01-05
6 2018-01-06
> forecastno2<-predict(mno2,futureno2)
> head(forecastno2)
          ds    trend    seasonal seasonal_lower seasonal_upper seasonalities seasonalities_lower
1 2018-01-01 4.561190  0.05192183     0.05192183     0.05192183    0.05192183          0.05192183
2 2018-01-02 4.557558 -0.04941725    -0.04941725    -0.04941725   -0.04941725         -0.04941725
3 2018-01-03 4.553925  0.01260751     0.01260751     0.01260751    0.01260751          0.01260751
4 2018-01-04 4.550293  0.03282689     0.03282689     0.03282689    0.03282689          0.03282689
5 2018-01-05 4.546660  0.05855911     0.05855911     0.05855911    0.05855911          0.05855911
6 2018-01-06 4.543028 -0.10872167    -0.10872167    -0.10872167   -0.10872167         -0.10872167
  seasonalities_upper      weekly weekly_lower weekly_upper yhat_lower yhat_upper trend_lower trend_upper
1          0.05192183  0.05192183   0.05192183   0.05192183   4.066993   5.107536    4.561190    4.561190
2         -0.04941725 -0.04941725  -0.04941725  -0.04941725   4.005698   5.027264    4.557558    4.557558
3          0.01260751  0.01260751   0.01260751   0.01260751   4.026793   5.090783    4.553925    4.553925
4          0.03282689  0.03282689   0.03282689   0.03282689   4.069073   5.072711    4.550293    4.550293
5          0.05855911  0.05855911   0.05855911   0.05855911   4.036568   5.132652    4.546660    4.546660
6         -0.10872167 -0.10872167  -0.10872167  -0.10872167   3.941829   4.937608    4.543028    4.543028
      yhat
1 4.613112
2 4.508141
3 4.566533
4 4.583120
5 4.605219
6 4.434306
> tail(forecastno2)
           ds    trend     seasonal seasonal_lower seasonal_upper seasonalities seasonalities_lower
69 2018-03-10 4.319357 -0.108721672   -0.108721672   -0.108721672  -0.108721672        -0.108721672
70 2018-03-11 4.315812  0.002223572    0.002223572    0.002223572   0.002223572         0.002223572
71 2018-03-12 4.312267  0.051921834    0.051921834    0.051921834   0.051921834         0.051921834
72 2018-03-13 4.308722 -0.049417247   -0.049417247   -0.049417247  -0.049417247        -0.049417247
73 2018-03-14 4.305178  0.012607506    0.012607506    0.012607506   0.012607506         0.012607506
74 2018-03-15 4.301633  0.032826894    0.032826894    0.032826894   0.032826894         0.032826894
   seasonalities_upper       weekly weekly_lower weekly_upper yhat_lower yhat_upper trend_lower trend_upper
69        -0.108721672 -0.108721672 -0.108721672 -0.108721672   3.699094   4.727220    4.319357    4.319357
70         0.002223572  0.002223572  0.002223572  0.002223572   3.798914   4.846963    4.315811    4.315813
71         0.051921834  0.051921834  0.051921834  0.051921834   3.870548   4.875105    4.312264    4.312271
72        -0.049417247 -0.049417247 -0.049417247 -0.049417247   3.743572   4.774393    4.308714    4.308730
73         0.012607506  0.012607506  0.012607506  0.012607506   3.789093   4.855644    4.305162    4.305191
74         0.032826894  0.032826894  0.032826894  0.032826894   3.808814   4.852220    4.301611    4.301653
       yhat
69 4.210635
70 4.318036
71 4.364189
72 4.259305
73 4.317785
74 4.334460
> tail(forecastno2[c('ds','yhat','yhat_lower','yhat_upper')])
           ds     yhat yhat_lower yhat_upper
69 2018-03-10 4.210635   3.699094   4.727220
70 2018-03-11 4.318036   3.798914   4.846963
71 2018-03-12 4.364189   3.870548   4.875105
72 2018-03-13 4.259305   3.743572   4.774393
73 2018-03-14 4.317785   3.789093   4.855644
74 2018-03-15 4.334460   3.808814   4.852220
> exp(4.31)
[1] 74.44049		
> exp(4.36)
[1] 78.25713




>plot(mno2,forecastno2)

 >prophet_plot_components(mno2,forecastno2)

 
#RSPM Prediction

> qplot(Date,rspm,data=bandrapro)

 

> summary(rspm)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   81.0   134.0   173.0   174.5   208.0   360.0 
> dsrspm<-bandrapro$Date

> y<-log(bandrapro$rspm)

> dfrspm<-data.frame(dsrspm,y)























> qplot(dsrspm,y,data=dfrspm)

 

> mrspm<-prophet(dfrspm)
Initial log joint probability = -2.13677
Optimization terminated normally: 
  Convergence detected: absolute parameter change was below tolerance
> futurerspm<-make_future_dataframe(mrspm,periods = 5)

> head(futurerspm)
          ds
1 2018-01-01
2 2018-01-02
3 2018-01-03
4 2018-01-04
5 2018-01-05
6 2018-01-06
> forecastrspm<-predict(mrspm,futurerspm)
> head(forecastrspm)
          ds    trend     seasonal seasonal_lower seasonal_upper seasonalities seasonalities_lower
1 2018-01-01 5.318143 -0.004131951   -0.004131951   -0.004131951  -0.004131951        -0.004131951
2 2018-01-02 5.311990  0.064348202    0.064348202    0.064348202   0.064348202         0.064348202
3 2018-01-03 5.305837  0.062675606    0.062675606    0.062675606   0.062675606         0.062675606
4 2018-01-04 5.299684  0.054075125    0.054075125    0.054075125   0.054075125         0.054075125
5 2018-01-05 5.293531 -0.030250167   -0.030250167   -0.030250167  -0.030250167        -0.030250167
6 2018-01-06 5.287378 -0.039439541   -0.039439541   -0.039439541  -0.039439541        -0.039439541
  seasonalities_upper       weekly weekly_lower weekly_upper yhat_lower yhat_upper trend_lower trend_upper
1        -0.004131951 -0.004131951 -0.004131951 -0.004131951   4.931148   5.652223    5.318143    5.318143
2         0.064348202  0.064348202  0.064348202  0.064348202   4.981623   5.718429    5.311990    5.311990
3         0.062675606  0.062675606  0.062675606  0.062675606   4.962259   5.762299    5.305837    5.305837
4         0.054075125  0.054075125  0.054075125  0.054075125   4.992524   5.731251    5.299684    5.299684
5        -0.030250167 -0.030250167 -0.030250167 -0.030250167   4.893541   5.629664    5.293531    5.293531
6        -0.039439541 -0.039439541 -0.039439541 -0.039439541   4.857950   5.597358    5.287378    5.287378
      yhat
1 5.314011
2 5.376338
3 5.368512
4 5.353759
5 5.263280
6 5.247938
> tail(forecastrspm)
           ds    trend     seasonal seasonal_lower seasonal_upper seasonalities seasonalities_lower
69 2018-03-10 4.898292 -0.039439541   -0.039439541   -0.039439541  -0.039439541        -0.039439541
70 2018-03-11 4.892061 -0.107277273   -0.107277273   -0.107277273  -0.107277273        -0.107277273
71 2018-03-12 4.885829 -0.004131951   -0.004131951   -0.004131951  -0.004131951        -0.004131951
72 2018-03-13 4.879598  0.064348202    0.064348202    0.064348202   0.064348202         0.064348202
73 2018-03-14 4.873366  0.062675606    0.062675606    0.062675606   0.062675606         0.062675606
74 2018-03-15 4.867135  0.054075125    0.054075125    0.054075125   0.054075125         0.054075125
   seasonalities_upper       weekly weekly_lower weekly_upper yhat_lower yhat_upper trend_lower trend_upper
69        -0.039439541 -0.039439541 -0.039439541 -0.039439541   4.471703   5.226102    4.898292    4.898292
70        -0.107277273 -0.107277273 -0.107277273 -0.107277273   4.423189   5.164915    4.892060    4.892061
71        -0.004131951 -0.004131951 -0.004131951 -0.004131951   4.488374   5.283365    4.885825    4.885833
72         0.064348202  0.064348202  0.064348202  0.064348202   4.544028   5.310001    4.879590    4.879605
73         0.062675606  0.062675606  0.062675606  0.062675606   4.544424   5.324450    4.873354    4.873379
74         0.054075125  0.054075125  0.054075125  0.054075125   4.535451   5.302674    4.867116    4.867154
       yhat
69 4.858852
70 4.784783
71 4.881697
72 4.943946
73 4.936042
74 4.921210
> tail(forecastrspm[c('ds','yhat','yhat_lower','yhat_upper')])
           ds     yhat yhat_lower yhat_upper
69 2018-03-10 4.858852   4.471703   5.226102
70 2018-03-11 4.784783   4.423189   5.164915
71 2018-03-12 4.881697   4.488374   5.283365
72 2018-03-13 4.943946   4.544028   5.310001
73 2018-03-14 4.936042   4.544424   5.324450
74 2018-03-15 4.921210   4.535451   5.302674
> exp(4.85)
[1] 127.7404
> exp(4.78)
[1] 119.1044

> plot(mrspm,forecastrspm)
 
> prophet_plot_components(mrspm,forecastrspm)

 
